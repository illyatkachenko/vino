
#ifndef LOCALIZATION_H
#define LOCALIZATION_H

#include <Arduino.h> // For PROGMEM, pgm_read_ptr, strncpy_P

// Enum for all localizable string keys
typedef enum {
    // Existing keys from localization.cpp (ensure this list is complete and matches)
    L_SETTINGS,
    L_DIAGNOSTICS,
    L_ERROR_LOG,
    L_DOSING_CONTROL,
    L_BACK_TO_STATUS,
    L_BACK_TO_SETTINGS,
    L_SAVE_AND_RESTART,
    L_SAVE,
    L_LANGUAGE,
    L_RUSSIAN,
    L_ENGLISH,
    L_SYSTEM_STATUS,
    L_POWER_STATUS,
    L_POWER_ON,
    L_POWER_OFF,
    L_DOSING_STATUS,
    L_CURRENT_VOLUME_DOSED,
    L_TARGET_VOLUME,
    L_TEMP_OUT,
    L_TEMP_OUT_FILTERED,
    L_TEMP_IN,
    L_TEMP_COOLER,
    L_COMPRESSOR_STATUS,
    L_COMPRESSOR_ON,
    L_COMPRESSOR_OFF,
    L_MOTOR_STATUS,
    L_MOTOR_RUNNING,
    L_MOTOR_STOPPED,
    L_SYSTEM_ERROR_STATUS,
    L_NO_ERROR, 
    L_TOTAL_DOSING_CYCLES,
    L_TOTAL_VOLUME_DOSED,
    L_UPTIME,
    L_FREE_HEAP,
    L_WIFI_SSID,
    L_WIFI_IP_ADDRESS,
    L_WIFI_MAC_ADDRESS,
    L_ESP_NOW_PEER_MAC,
    L_ESP_NOW_LAST_SENT_STATUS,
    L_ESP_NOW_LAST_RECV_STATUS,
    L_CONTROL_AND_SETTINGS,
    L_TOGGLE_POWER,
    L_RESET_STATS,
    L_CLEAR_ERROR,
    L_EMERGENCY_STOP,
    L_TOTAL_ERRORS,
    L_LAST_ERROR_MESSAGE,
    L_CALIBRATION_MODE_ACTIVE_MSG,
    L_STEPS_ACCUMULATED_MSG,
    L_SYSTEM_ERROR_TITLE,
    L_ERROR_CODE_LABEL,
    L_ERROR_TIME_LABEL,
    L_SECONDS_AGO_LABEL,
    L_STATUS_LABEL,
    L_OK_STATUS,
    L_DISABLE_PID_TEMP_CONTROL_BTN,
    L_ENABLE_PID_TEMP_CONTROL_BTN,
    L_DOWNLOAD_LOG_BTN,
    L_STATISTICS_TITLE,
    L_COMPRESSOR_RUNTIME_LABEL,
    L_HOURS_UNIT,
    L_COMPRESSOR_STARTS_LABEL,
    L_SYSTEM_SETTINGS_TITLE,
    L_MOTOR_SETTINGS,
    L_MOTOR_SPEED_DOSING,
    L_MOTOR_SPEED_CALIBRATION,
    L_ML_PER_STEP,
    L_ACCELERATION_STEPS,
    L_DECELERATION_STEPS,
    L_TEMP_SETTINGS,
    L_TEMP_SETPOINT_DOSING,
    L_PID_SETTINGS,
    L_PID_KP,
    L_PID_KI,
    L_PID_KD,
    L_PID_OUTPUT_MIN,
    L_PID_OUTPUT_MAX,
    L_ENABLE_PID_TEMP_CONTROL,
    L_FLOW_SENSOR_SETTINGS,
    L_ML_PER_PULSE,
    L_ESP_NOW_SETTINGS,
    L_REMOTE_PEER_MAC,
    L_CALIBRATION,
    L_CALIBRATE_MOTOR_ML_PER_STEP,
    L_TARGET_CALIBRATION_VOLUME,
    L_START_CALIBRATION,
    L_ACTUAL_VOLUME_MEASURED,
    L_STOP_AND_SAVE_CALIBRATION,
    L_CALIBRATE_FLOW_SENSOR,
    L_TARGET_FLOW_CALIBRATION_VOLUME,
    L_START_FLOW_CALIBRATION,
    L_ACTUAL_VOLUME_FLOW_SENSOR,
    L_STOP_AND_SAVE_FLOW_CALIBRATION,
    L_MANUAL_MOTOR_CONTROL_CAL_MODE,
    L_FORWARD,
    L_REVERSE,
    L_STOP,
    L_OTHER_SETTINGS,
    L_WIFI_SETTINGS,
    L_ML_PER_PULSE_FLOW_SENSOR_CAL_LABEL,
    L_DOSING_CONTROL_SETTINGS_TITLE,
    L_DOSING_VOLUME_ML_LABEL,
    L_START_DOSING_BTN,
    L_CURRENT_ML_PER_STEP_MOTOR_LABEL,
    L_CURRENT_ML_PER_PULSE_FLOW_LABEL,
    L_ACCUMULATED_FLOW_PULSES_LABEL,
    L_MOTOR_FORWARD_CAL_BTN,
    L_MOTOR_REVERSE_CAL_BTN,
    L_MOTOR_STOP_CAL_BTN,
    L_FINISH_MOTOR_CALIBRATION_BTN,
    L_FINISH_FLOW_CALIBRATION_BTN,
    L_TARGET_CALIBRATION_VOLUME_HINT_LABEL,
    L_START_CALIBRATION_MOTOR_FLOW_BTN,
    L_PID_SETTINGS_TITLE_MOTOR_SPEED,
    L_PID_TEMP_CONTROL_STATUS_LABEL,
    L_ENABLED_STATUS,
    L_DISABLED_STATUS,
    L_TOGGLE_ON_MAIN_PAGE_HINT,
    L_SAVE_PID_COEFFS_BTN,
    L_ARE_YOU_SURE_FACTORY_RESET_CONFIRM_MSG,
    L_FACTORY_RESET,
    L_PERFORM_FACTORY_RESET,
    L_ARE_YOU_SURE_FACTORY_RESET,
    L_DOSING_CONTROL_TITLE,
    L_CURRENT_DOSING_STATE,
    L_TARGET_TEMP_C,
    L_TARGET_DOSING_VOLUME_ML,
    L_SAVE_AND_START_DOSING,
    L_STOP_DOSING,
    L_WIFI_SETUP_TITLE,
    L_CURRENT_WIFI_SSID,
    L_NEW_SSID,
    L_NEW_PASSWORD_LEAVE_EMPTY,
    L_ERROR_LOG_TITLE,
    L_NO_STORED_ERRORS,
    L_TIME_AGO,
    L_CODE,
    L_MESSAGE,
    L_AP_CONFIG_TITLE,
    L_AP_CONFIG_PROMPT,
    L_AP_SSID_LABEL,
    L_AP_PASSWORD_LABEL,
    L_AP_SELECT_FROM_LIST,
    L_AP_OR_ENTER_MANUALLY,
    L_AP_AVAILABLE_NETWORKS,
    L_AP_NETWORK_NAME,
    L_AP_SIGNAL_STRENGTH,
    L_AP_SECURITY,
    L_AP_SELECT,
    L_AP_SAVE_WIFI_CREDENTIALS,
    L_AP_SAVE_AND_CONNECT_BTN,
    L_AP_UPDATE_NETWORK_LIST,
    L_AP_SIMPLE_PAGE_TITLE,
    L_AP_SIMPLE_PAGE_PROMPT,
    L_AP_SECURITY_OPEN,
    L_AP_SECURITY_ENCRYPTED,
    L_AP_NO_NETWORKS_FOUND,
    L_DOSING_STATE_IDLE,
    L_DOSING_STATE_REQUESTED,
    L_DOSING_STATE_PRE_COOLING,
    L_DOSING_STATE_STARTING,
    L_DOSING_STATE_RUNNING,
    L_DOSING_STATE_STOPPING,
    L_DOSING_STATE_PAUSED,
    L_DOSING_STATE_FINISHED,
    L_DOSING_STATE_ERROR,
    L_DOSING_STATE_UNKNOWN, 
    L_DIAGNOSTICS_INFO_TITLE,
    L_GENERAL_STATUS_TITLE,
    L_BYTES_UNIT,
    L_AP_CONFIGURE_WIFI_NAVIGATE,
    L_LITTLEFS_MOUNT_FAILED_LOG_DISABLED,
    L_REBOOTED_DUE_TO_FATAL_ERROR,
    L_FATAL_ERROR_FLAG_CLEARED_MSG,
    L_PREFS_OPEN_FAIL_CLEAR_FATAL_FLAG,
    L_PREFS_OPEN_FAIL_CHECK_FATAL_FLAG,
    L_RESET_BUTTON_PRESSED_HOLD_MSG,
    L_RESET_BUTTON_RELEASED_CANCEL_MSG,
    L_RESET_BUTTON_HELD_RESTART_MSG,
    L_NO_ACTIVE_ERROR_MSG, 
    L_UNKNOWN_ERROR_CODE_DESC_MSG, 
    L_ERROR_DESC_NO_ERROR,
    L_ERROR_DESC_WIFI_ERROR,
    L_ERROR_DESC_CALIBRATION_ERROR,
    L_ERROR_CAL_ACTIVE_CANNOT_DOSE,
    L_ERROR_SYS_NOT_POWERED_CANNOT_DOSE,
    L_ERROR_DOSING_CYCLE_BUSY_OR_ERROR,
    L_ERROR_FLOW_SENSOR_NOT_CALIBRATED,
    L_ERROR_DOSING_REQUESTED_SYS_NOT_POWERED,
    L_ERROR_PRECOOLING_TIMEOUT,
    L_ERROR_DOSING_START_ABORTED_TOUT_FAIL,
    L_ERROR_MOTOR_SPEED_ZERO_CANNOT_DOSE,
    L_ERROR_MAX_DOSING_DURATION_TIMEOUT,
    L_ERROR_ESPNOW_INIT_FAIL,
    L_ERROR_ESPNOW_RECV_CB_REGISTER_FAIL,
    L_ERROR_ESPNOW_PEER_ADD_READD_FAIL,
    L_ERROR_INVALID_PEER_MAC_IN_CONFIG,
    L_ERROR_EMERGENCY_STOP_VIA_ESPNOW,
    L_WARN_ESPNOW_SEND_FAIL_AFTER_RETRIES,
    L_ERROR_PREFS_DEFAULTS_APPLIED_OPEN_FAIL,
    L_INFO_STATISTICS_RESET_MSG,
    L_ERROR_CALIBRATION_ALREADY_ACTIVE,
    L_ERROR_SYS_NOT_POWERED_CANNOT_CALIBRATE,
    L_ERROR_DOSING_CYCLE_ACTIVE_CANNOT_CALIBRATE,
    L_ERROR_INVALID_MOTOR_CALIBRATION_DATA,
    L_ERROR_CALIBRATION_NOT_ACTIVE_MOTOR,
    L_ERROR_CALIBRATION_NOT_ACTIVE_FLOW,
    L_ERROR_INVALID_FLOW_CALIBRATION_DATA,
    L_ERROR_CALIBRATION_TIMED_OUT_MOTOR_STOPPED,

    L_KEY_COUNT 
} LangKey;

void localization_init_default_lang();
void set_current_language(const char* lang_code);
const char* get_current_language_code();
const char* _T(LangKey key);

#endif // LOCALIZATION_H